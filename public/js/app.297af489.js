(function(t){function e(e){for(var a,i,n=e[0],c=e[1],l=e[2],h=0,d=[];h<n.length;h++)i=n[h],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&d.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(d.length)d.shift()();return r.push.apply(r,l||[]),s()}function s(){for(var t,e=0;e<r.length;e++){for(var s=r[e],a=!0,n=1;n<s.length;n++){var c=s[n];0!==o[c]&&(a=!1)}a&&(r.splice(e--,1),t=i(i.s=s[0]))}return t}var a={},o={app:0},r=[];function i(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=a,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],c=n.push.bind(n);n.push=e,n=n.slice();for(var l=0;l<n.length;l++)e(n[l]);var u=c;r.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";s("85ec")},"3ff3":function(t,e,s){},"4e68":function(t,e,s){"use strict";s("3ff3")},"56d7":function(t,e,s){"use strict";s.r(e);s("e260"),s("e6cf"),s("cca6"),s("a79d");var a,o=s("2b0e"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("router-view")],1)},i=[],n={name:"App"},c=n,l=(s("034f"),s("2877")),u=Object(l["a"])(c,r,i,!1,null,null,null),h=u.exports,d=(s("d3b7"),s("ac1f"),s("5319"),s("bc3a")),p=s.n(d),f=s("ade3"),m=s("2f62"),g="login",y="logout",v="title";o["default"].use(m["a"]);var _=new m["a"].Store({state:{user:{},token:null,title:""},mutations:(a={},Object(f["a"])(a,g,(function(t,e){localStorage.token=e,t.token=e})),Object(f["a"])(a,y,(function(t){localStorage.removeItem("token"),t.token=null})),Object(f["a"])(a,v,(function(t,e){t.title=e})),a)}),S=s("8c4f"),b=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"logout"},[a("el-button",{attrs:{type:"primary"},on:{click:t.logout}},[t._v("登出")])],1),a("el-row",[a("el-col",{attrs:{offset:10,span:4}},[a("img",{staticClass:"logo",attrs:{src:s("9d64"),alt:"dataai"}})])],1),a("el-row",[a("el-col",{staticClass:"center",attrs:{span:8,offset:8}},[a("el-input",{attrs:{placeholder:"请输入关键词进行搜索"},on:{focus:t.focus,blur:t.blur,input:t.getSuggest},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchHandler(e)}},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}},[a("el-button",{attrs:{slot:"append",type:"primary",icon:"el-icon-search"},on:{click:t.searchHandler},slot:"append"},[t._v("搜索")])],1),t.isSearch?a("el-card",{staticClass:"box-card",staticStyle:{position:"relative","z-index":"15"},attrs:{id:"search-box"},on:{mouseenter:t.enterSearchBoxHandler}},[t.isHistorySearch?a("dl",[a("dt",{directives:[{name:"show",rawName:"v-show",value:t.history,expression:"history"}],staticClass:"search-title"},[t._v("历史搜索")]),a("dt",{directives:[{name:"show",rawName:"v-show",value:t.history,expression:"history"}],staticClass:"remove-history",on:{click:t.removeAllHistory}},[a("i",{staticClass:"el-icon-delete"}),t._v("清空历史记录 ")]),t._l(t.historySearchList,(function(e,s){return a("el-tag",{key:s,staticStyle:{"margin-right":"5px","margin-bottom":"5px"},attrs:{closable:"",type:e},on:{click:function(s){return t.toSearch(e)},close:function(s){return t.closeHandler(e)}}},[t._v(t._s(e))])})),a("dt",{staticClass:"search-title"},[t._v("热门搜索")]),t._l(t.hotSearchList,(function(e,s){return a("el-tag",{key:s,staticStyle:{"margin-right":"5px","margin-bottom":"5px"},attrs:{closable:"",type:e},on:{click:function(s){return t.toSearch(e)},close:function(s){return t.closeHandler(e)}}},[t._v(t._s(e))])}))],2):t._e(),t.isSearchList?a("dl",t._l(t.searchList,(function(e){return a("dd",{key:e.id,on:{click:function(s){return t.toSearch(e)}}},[t._v(t._s(e))])})),0):t._e()]):t._e()],1)],1)],1)},w=[],k=(s("4de4"),s("a434"),{data:function(){return{keywords:"",isFocus:!1,hotSearchList:["暂无热门搜索"],historySearchList:[],searchList:["暂无数据"],history:!1}},mounted:function(){this.getHotSearch()},methods:{logout:function(){var t=this;console.log("asdf"),this.axios.get("http://127.0.0.1/api/logout").then((function(e){"success"===e.data.status&&(console.log(e.data),t.$store.commit(g,""),t.$router.push({path:"login"}))}))},focus:function(){this.isFocus=!0,this.historySearchList=null==JSON.parse(localStorage.getItem("searchHistory"))?[]:JSON.parse(localStorage.getItem("searchHistory")),this.history=0!==this.historySearchList.length},blur:function(){var t=this;this.searchBoxTimeout=setTimeout((function(){t.isFocus=!1}),300)},getSuggest:function(){var t=this;this.keywords&&this.axios.post("http://127.0.0.1/api/suggest",{s:this.keywords}).then((function(e){"success"===e.data.status&&(t.searchList=e.data.data)}))},getHotSearch:function(){var t=this;this.axios.get("http://127.0.0.1/api/hot").then((function(e){"success"===e.data.status&&(t.hotSearchList=e.data.data)}))},enterSearchBoxHandler:function(){clearTimeout(this.searchBoxTimeout)},toSearch:function(t){this.$router.push({name:"result",params:{q:t}})},searchHandler:function(){var t=this,e=0!==this.historySearchList.filter((function(e){return e===t.keywords})).length;!e&&this.keywords&&(this.historySearchList.push(this.keywords),localStorage.setItem("searchHistory",JSON.stringify(this.historySearchList))),this.history=0!==this.historySearchList.length,this.$router.push({path:"result",query:{q:this.keywords}})},closeHandler:function(t){this.historySearchList.splice(this.historySearchList.indexOf(t),1),localStorage.setItem("searchHistory",JSON.stringify(this.historySearchList)),clearTimeout(this.searchBoxTimeout),0===this.historySearchList.length&&(this.history=!1)},removeAllHistory:function(){localStorage.removeItem("searchHistory")}},computed:{isHistorySearch:function(){return this.isFocus&&!this.keywords},isSearchList:function(){return this.isFocus&&this.keywords},isSearch:function(){return this.isFocus}}}),x=k,C=(s("6e54"),Object(l["a"])(x,b,w,!1,null,null,null)),L=C.exports,O=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-form",{ref:"loginForm",staticClass:"login-box",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[s("h3",{staticClass:"login-title"},[t._v("欢迎登录DATAAI")]),s("el-form-item",{attrs:{label:"账号",prop:"username"}},[s("el-input",{attrs:{type:"text",placeholder:"请输入账号",autocomplete:"off"},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"off"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.login("loginForm")}}},[t._v("登录")])],1)],1),s("el-dialog",{attrs:{title:"温馨提示",visible:t.dialogVisible,width:"30%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("span",[t._v(t._s(t.diaMessage))]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确 定")])],1)])],1)},H=[],$={data:function(){return{form:{username:"",password:""},diaMessage:"",rules:{username:[{required:!0,message:"账号不可为空",trigger:"blur"}],password:[{required:!0,message:"密码不可为空",trigger:"blur"}]},dialogVisible:!1,token:""}},mounted:function(){this.$store.commit(v,"Login")},methods:{login:function(t){var e=this;this.$refs[t].validate((function(t){if(!t)return e.dialogVisible=!0,!1;var s={name:e.form.username,password:e.form.password};e.axios.post("http://127.0.0.1/api/login",s).then((function(t){if("success"===t.data.status){e.$store.commit(g,t.data.data.access_token);var s=decodeURIComponent(e.$route.query.redirect||"/");e.$router.push({path:s})}else e.dialogVisible=!0,e.diaMessage=t.data.status}))}))},handleClose:function(){console.log("close")}}},j=$,q=(s("4e68"),Object(l["a"])(j,O,H,!1,null,"4b2e78ef",null)),I=q.exports,P=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"main"}},[a("div",{staticClass:"logout",staticStyle:{"z-index":"99"}},[a("el-button",{attrs:{type:"primary"},on:{click:t.logout}},[t._v("登出")])],1),a("el-container",[a("el-header",[a("el-row",[a("el-col",{attrs:{span:2}},[a("a",{attrs:{href:"/"}},[a("div",{staticClass:"logo"},[a("img",{staticClass:"logo",attrs:{src:s("9d64"),alt:"dataai"}})])])]),a("el-col",{attrs:{span:6}},[a("el-input",{attrs:{type:"text",placeholder:"请输入关键词进行搜索"},model:{value:t.keywords,callback:function(e){t.keywords=e},expression:"keywords"}},[a("el-button",{attrs:{slot:"append"},on:{click:t.addSearch},slot:"append"},[t._v("搜索")])],1)],1)],1)],1),a("el-container",[a("el-main",[a("el-row",[a("el-col",{attrs:{span:10,offset:2}},[a("span",{staticClass:"summary"},[t._v("找到约 "),a("span",{staticClass:"totalResult"},[t._v(t._s(t.total))]),t._v(" 条结果(用时"),a("span",{staticClass:"time"},[t._v(t._s(t.last_seconds))]),t._v("秒)，共约"),a("span",{staticClass:"totalPage"},[t._v(t._s(t.page_nums))]),t._v("页")])])],1),a("el-row",[a("el-col",{attrs:{offset:2}},[a("div",{staticClass:"resultList"},t._l(t.hit_list,(function(e,s){return a("div",{key:s,staticClass:"resultItem"},[a("div",{staticClass:"itemHead"},[a("span",{staticClass:"from"},[a("span",{staticClass:"label"},[t._v("来源：")]),a("span",{staticClass:"value"},[t._v(t._s(e.nickname)+"("+t._s(e.wxid)+")")])]),a("span",{staticClass:"dependValue"},[a("span",{staticClass:"label"},[t._v("得分：")]),a("span",{staticClass:"value"},[t._v(t._s(e.score))])])]),a("div",{staticClass:"itemBody",domProps:{innerHTML:t._s(e.content)}}),a("div",{staticClass:"itemFoot"},[a("span",{staticClass:"info"},[a("label",[t._v("发送人：")]),a("span",{staticClass:"value"},[t._v(t._s(e.message_sender))])]),a("span",{staticClass:"info"},[a("label",[t._v("群昵称：")]),a("span",{staticClass:"value"},[t._v(t._s(e.message_group))])]),a("span",{staticClass:"info"},[a("label",[t._v("发布时间：")]),a("span",{staticClass:"value"},[t._v(t._s(e.create_date))])])])])})),0)])],1)],1),a("el-aside",{attrs:{width:"300px"}},[a("div",{staticClass:"historyArea"},[a("div",{staticClass:"hotSearch"},[a("h6",[t._v("热门搜索")]),a("div",{staticClass:"historyList"},t._l(t.hotSearchList,(function(e,s){return a("p",{key:s,on:{click:function(s){return t.changeKeywords(e)}}},[t._v(" "+t._s(e)+" ")])})),0)]),a("div",{staticClass:"mySearch"},[a("h6",[t._v("我的搜索")]),a("div",{staticClass:"historyList"},t._l(t.mySearchList,(function(e,s){return a("p",{key:s,on:{click:function(s){return t.changeKeywords(e)}}},[t._v(" "+t._s(e)+" ")])})),0)])])])],1),a("el-footer",[a("el-row",[a("el-col",{attrs:{align:"left",offset:2}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":Number(this.page),"page-size":10,total:this.total},on:{"current-change":t.changePage}})],1)],1),a("div",{staticClass:"footer"},[t._v(" Copyright 版权所有 E-mail:search@dataai.cn ")])],1)],1)],1)},A=[],T={name:"Result",mounted:function(){this.getQuery(),this.addSearch(),this.getSearchList()},data:function(){return{keywords:"",total:0,page:1,page_nums:0,last_seconds:0,hit_list:[],hotSearchList:["暂无热门词"],mySearchList:["暂无历史搜索"]}},methods:{getQuery:function(){this.keywords=this.$route.params.q},getSearchList:function(){var t=this;this.axios.get("http://127.0.0.1/api/hot").then((function(e){"success"===e.data.status&&(t.hotSearchList=e.data.data)})),this.mySearchList=null==JSON.parse(localStorage.getItem("searchHistory"))?[]:JSON.parse(localStorage.getItem("searchHistory"))},changeKeywords:function(t){this.keywords=t,this.addSearch()},changePage:function(t){this.page=t,this.addSearch()},logout:function(){var t=this;console.log("asdf"),this.axios.get("http://127.0.0.1/api/logout").then((function(e){"success"===e.data.status&&(console.log(e.data),t.$store.commit(g,""),t.$router.push({path:"login"}))}))},addSearch:function(){var t=this;if(this.keywords&&this.keywords.length>=2){var e=0!==this.mySearchList.filter((function(e){return e===t.keywords})).length;e||(this.mySearchList.push(this.keywords),localStorage.setItem("searchHistory",JSON.stringify(this.mySearchList)));var s="http://127.0.0.1/api/search?q="+this.keywords+"&p="+this.page;this.axios.get(s).then((function(e){var s=e.data.data;t.hit_list=s.hit_list,t.keywords=s.keywords,t.last_seconds=s.last_seconds,t.page=s.page,t.page_nums=s.page_nums,t.hot_search=s.hot_search,t.total=s.total})).catch((function(t){console.log(t)}))}}}},N=T,F=(s("9709"),s("c8b3"),Object(l["a"])(N,P,A,!1,null,"404316cc",null)),J=F.exports;o["default"].use(S["a"]);var M=[{path:"/",name:"/",meta:{requireAuth:!0},component:L},{path:"/result",name:"result",meta:{requireAuth:!0},component:J},{path:"/login",name:"login",component:I}];window.localStorage.getItem("token")&&_.commit(g,window.localStorage.getItem("token"));var E=new S["a"]({routes:M});E.beforeEach((function(t,e,s){t.matched.some((function(t){return t.meta.requireAuth}))?_.state.token?s():s({path:"/login",query:{redirect:t.fullPath}}):s()}));var V=E;p.a.defaults.timeout=5e3,p.a.defaults.baseURL="https://api.github.com",p.a.interceptors.request.use((function(t){return _.state.token&&(t.headers.Authorization="token ".concat(_.state.token)),t}),(function(t){return Promise.reject(t)})),p.a.interceptors.response.use((function(t){return t}),(function(t){if(t.response)switch(t.response.status){case 401:_.commit(y),"login"!==V.currentRoute.path&&V.replace({path:"login",query:{redirect:V.currentRoute.path}})}return Promise.reject(t.response.data)}));var B=p.a,R=s("5c96"),z=s.n(R);s("0fae");o["default"].use(z.a),o["default"].config.productionTip=!1,o["default"].prototype.axios=B,new o["default"]({el:"#app",axios:B,router:V,store:_,render:function(t){return t(h)}}).$mount("#app")},"6c63":function(t,e,s){},"6e54":function(t,e,s){"use strict";s("7ef0")},"7ef0":function(t,e,s){},"85ec":function(t,e,s){},9709:function(t,e,s){"use strict";s("afa8")},"9d64":function(t,e,s){t.exports=s.p+"img/logo.116bd84a.png"},afa8:function(t,e,s){},c8b3:function(t,e,s){"use strict";s("6c63")}});
//# sourceMappingURL=app.297af489.js.map